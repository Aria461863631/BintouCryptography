## 选做题2：攻击RSA模数

> 请分解：8419248954524000439721779172023134688983838205866625782151550834434276874684863239544369195264071670152656061813873751842115416791829324879655667191724512456544905595733991629887800889255133717212624547817690492648616532902257249552981800714896543008295153051040335475732125114592095784407296265046992475467

sol:

2901594209141588502650222215814396586003195843612160434765689337683632253922307845012747360431881459197582849873533200212023894921607275433777719963916**383** *
  2901594209141588502650222215814396586003195843612160434765689337683632253922307845012747360431881459197582849873533200212023894921607275433777719963916**949**



>  并说明为什么能分解。

find that p and q only differs in last 3 digits (decimal)

means that p and q are close to $ \sqrt{n} $

Easily factorized by **Fermat's method**.

- enumerates integers $ b ​$ from $ 0 ​$ onward
- stop when $ N+b^2 $ is a square $ a^2 $
- therefore $ p $ and $ q $ are $ (a+b)/2 $ and $ (a−b)/2 $. 

So we need to make sure  $p $ and $ q $ are primes in range $ [2^{(n−1)/2}…2^{n/2}] $ or  $ |p–q|>2^{(n/2)–100} $ where $ n $ is bitlength of $ N $ ( ANSI X9.31 and FIPS 186)

If we choose **random** primes `p` and `q` in the range `[2^511, 2^512]` , this isn't going to happen with any sort of realistic **probability**.