## 选做题4：攻击RSA

RSA算法的使用一般要求每个不同的用户有一个独立的模数N。有天，Bob脑洞大开，认为似乎没有必要这样做。只需要一个模数N，然后给不同的用户分发不同的e和d就好了。可惜这种做法有严重的安全漏洞。



给定Alice的公钥（e1，N），Adv为了破解Alice的密文，他也注册一个公私钥对，得到(e2, d2, N)，然后他就可以巧妙地计算出Alice的解密私钥。注意：Adv得到的私钥不一定与Alice的相同，只是它确实可以解密。



e1 =

44379563805854841580307748547737435172564831877127303051909203409873174780389273150966396080375621148040275710628408649117613085199533826455458312376264659153842853015345496268736337902730232293424031775369541079662258443836020140399047886828048837071536578243295077689245549921524765222192270061081366989243

 

N = 

188115669939527035644766943794256836704505079895306601119938518634078379404429524926183546093986493443422022468844644307633083886388295943602507953702360632321739073592477683222131866451975315695813478098524853358977564134499058448438525811837376172990710150323209055804682074564005014776547535959114226010493

）



(e2 =

112465763139808984065405993827008716763974555200543206549100182421914260511395374512318119557311872118857352370325610769529155517454000609905909538235321637165438962672069969201523246380106126889874030417878823876408727390390051948217715186480658609481138938023687641185709391304878382079926539531855678365763



d2 =

55881649455902117785162844948995531081646760354831350250450328774662614334096209227124014992837725793190883247171284132768863157972472923057215962250425474753160669444247876851199006665484502793278672692761545198268608005712388135980371518592854149756626148424994498979112285655516912703587302199972664162731

)



求解(e1, N)加密得到的密文（没有编码，是一个整数）：

166834578157098529809222592291594342260836191039081705782260506690911922650094691879568641873546447862853989518762075081785381252999566333779425586950217410876199240677942391128773211264433855236931134494842223272683014826519273429450763047329625425561073729238027952900168036140503255431512655421527963913597



**解密结果**:

- ​                        $ 131 $ 

!!━━━(ﾟ∀ﾟ≡(ﾟ∀ﾟ≡ﾟ∀ﾟ)≡ﾟ∀ﾟ)━━━━!!



请解释过程，给出明文及其解密用的私钥。

根据
$$
e_2d_2 - 1 = k\phi(n) \\
$$
求解扩展欧几里德 (k未知)
$$
e_1x + (k\phi(n))y = g
$$
因为$e_1$与$\phi(n)$互素, 所以 $g$ 只可能是和 $k$ 的公因子

两边同时除 $ g $ 得
$$
e_1x^{'} + (\frac{k}{g}*y)\phi(n) = 1
$$
则有
$$
e_1x^{'} = 1 \pmod{ \phi(n)}
$$
明文 m 为 
$$
c ^ {x'} = (m^{e_1} ) ^ {x'} = m
$$


如果$x'$为负数, 则有 
$$
(m^{e_1} ) ^ { - |x'|} = {((m^{e_1})^{-1})}^{|x^{'}|}
$$
对 $ x' $ 取反对 $c$ 取逆元即可 



